(function($){$.fn.extend({smoothproducts:function(){var smallPics=$(".sp-thumbnail");var bigHref=$(smallPics[0]).attr("href");if(smallPics.length==1){}else if(smallPics.length<=5){$(".sp-thumbs-wrap").show();$(".sp-small-btn").remove();$(".sp-thumbs-wrap").css("padding","0");$(".sp-thumbnail").css("margin","0 7px")}else{$(".sp-thumbs-wrap").show();var smallNum=smallPics.length;var smallWidth=$(smallPics[0]).width();$(".sp-thumbs").width(smallNum*(smallWidth+10));var smallExtra=$(".sp-thumbs").width()-$(".sp-small-pics").width()}smallPics.on("click",function(){bigHref=$(this).attr("src");smallPics.removeClass("sp-current");$(this).addClass("sp-current");$(".sp-large a").attr({href:bigHref});$(".sp-large a img").attr({src:bigHref})});$(document.body).on("click",".sp-small-btn",function(){var left=parseInt($(".sp-thumbs").css("left"));var right=parseInt($(".sp-thumbs").css("right"));if($(this).hasClass("sp-small-next")){left=left-58}else{left=left+58}$(".sp-thumbs").css("left",left);if(left>0){$(".sp-thumbs").css("left",0)}else if(left<-1*smallExtra){$(".sp-thumbs").css("left",-1*smallExtra)}});$(document.body).on("click",".sp-thumbs",function(event){event.preventDefault()});$(document.body).on("mouseover",function(event){$(".sp-wrap").removeClass("sp-touch").addClass("sp-non-touch");event.preventDefault()});$(document.body).on("touchstart",function(){$(".sp-wrap").removeClass("sp-non-touch").addClass("sp-touch")});$(document.body).on("mouseenter",".sp-non-touch .sp-large",function(event){var largeUrl=$("a",this).attr("href");$(this).append('<div class="sp-zoom"><img src="'+largeUrl+'"/></div>');$(this).find(".sp-zoom").fadeIn(250);event.preventDefault()});$(document.body).on("mouseleave",".sp-non-touch .sp-large",function(event){$(this).find(".sp-zoom").fadeOut(250,function(){$(this).remove()});event.preventDefault()});$(document.body).on("click",".sp-non-touch .sp-zoom",function(event){var currentImg=$(this).html(),thumbAmt=$(this).parents(".sp-wrap").find(".sp-thumbs img").length,currentThumb=$(this).parents(".sp-wrap").find(".sp-thumbs .sp-current").index()+1;$(this).parents(".sp-wrap").addClass("sp-selected");$("body").append("<div class='sp-lightbox' data-currenteq='"+currentThumb+"'>"+currentImg+"</div>");if(thumbAmt>1){$(".sp-lightbox").append("<a href='#' id='sp-prev'></a><a href='#' id='sp-next'></a>");if(currentThumb==1){$("#sp-prev").css("opacity",".1")}else if(currentThumb==thumbAmt){$("#sp-next").css("opacity",".1")}}$(".sp-lightbox").fadeIn();event.preventDefault()});$(document.body).on("click",".sp-large a",function(event){var currentImg=$(this).attr("href"),thumbAmt=$(this).parents(".sp-wrap").find(".sp-thumbs img").length,currentThumb=$(this).parents(".sp-wrap").find(".sp-thumbs .sp-current").index()+1;$(this).parents(".sp-wrap").addClass("sp-selected");$("body").append('<div class="sp-lightbox" data-currenteq="'+currentThumb+'"><img src="'+currentImg+'"/></div>');if(thumbAmt>1){$(".sp-lightbox").append("<a href='#' id='sp-prev'></a><a href='#' id='sp-next'></a>");if(currentThumb==1){$("#sp-prev").css("opacity",".1")}else if(currentThumb==thumbAmt){$("#sp-next").css("opacity",".1")}}$(".sp-lightbox").fadeIn();event.preventDefault()});$(document.body).on("click","#sp-next",function(event){event.stopPropagation();var currentEq=$(".sp-lightbox").data("currenteq"),totalItems=$(".sp-selected .sp-thumbs img").length;if(currentEq>=totalItems){}else{var nextEq=currentEq+1,newImg=$(".sp-selected .sp-thumbs").find("img:eq("+currentEq+")").attr("src"),newThumb=newImg;if(currentEq==totalItems-1){$("#sp-next").css("opacity",".1")}$("#sp-prev").css("opacity","1");$(".sp-selected .sp-current").removeClass();$(".sp-selected .sp-thumbs img:eq("+currentEq+")").addClass("sp-current");$(".sp-selected .sp-large").empty().append("<a href="+newImg+'><img src="'+newThumb+'"/></a>');$(".sp-lightbox img").fadeOut(250,function(){$(this).remove();$(".sp-lightbox").data("currenteq",nextEq).append('<img src="'+newImg+'"/>');$(".sp-lightbox img").hide().fadeIn(250)})}event.preventDefault()});$(document.body).on("click","#sp-prev",function(event){event.stopPropagation();var currentEq=$(".sp-lightbox").data("currenteq"),currentEq=currentEq-1;if(currentEq<=0){}else{if(currentEq==1){$("#sp-prev").css("opacity",".1")}var nextEq=currentEq-1,newImg=$(".sp-selected .sp-thumbs").find("img:eq("+nextEq+")").attr("src"),newThumb=newImg;$("#sp-next").css("opacity","1");$(".sp-selected .sp-current").removeClass();$(".sp-selected .sp-thumbs img:eq("+nextEq+")").addClass("sp-current");$(".sp-selected .sp-large").empty().append("<a href="+newImg+'><img src="'+newThumb+'"/></a>');$(".sp-lightbox img").fadeOut(250,function(){$(this).remove();$(".sp-lightbox").data("currenteq",currentEq).append('<img src="'+newImg+'"/>');$(".sp-lightbox img").hide().fadeIn(250)})}event.preventDefault()});$(document.body).on("click",".sp-lightbox",function(){closeModal()});$(document).keydown(function(e){if(e.keyCode==27){closeModal();return false}});function closeModal(){$(".sp-selected").removeClass("sp-selected");$(".sp-lightbox").fadeOut(function(){$(this).remove()})}$(".sp-large").mousemove(function(e){var viewWidth=$(this).width(),viewHeight=$(this).height(),largeWidth=$(this).find(".sp-zoom").width(),largeHeight=$(this).find(".sp-zoom").height(),parentOffset=$(this).parent().offset(),relativeXPosition=e.pageX-parentOffset.left,relativeYPosition=e.pageY-parentOffset.top,moveX=Math.floor(relativeXPosition*(viewWidth-largeWidth)/viewWidth),moveY=Math.floor(relativeYPosition*(viewHeight-largeHeight)/viewHeight);$(this).find(".sp-zoom").css({left:moveX,top:moveY})});function get_url_from_background(bg){return bg.match(/url\([\"\']{0,1}(.+)[\"\']{0,1}\)+/i)[1]}}})})($);